<div
  class="fs-date-picker-dialog opened {{ 'dialog-view-' + datePickerModel.view }}"
  tabindex="0"
  [ngClass]="{
      'has-view-date': datePickerModel.view === 'date' || datePickerModel.view === 'datetime',
      'has-view-time': datePickerModel.view === 'time' || datePickerModel.view === 'datetime',
      'date-mode-date-time': (datePickerModel.calendarMode$ | async) === 'datetime',
      'date-mode-date': (datePickerModel.calendarMode$ | async) === 'date',
      'date-mode-month': (datePickerModel.calendarMode$ | async) === 'month',
      'date-mode-year': (datePickerModel.calendarMode$ | async) === 'year',
      'date-mode-week': (datePickerModel.calendarMode$ | async) === 'week',
      'picker-tab-date': selectedDateTimeTab === 0,
      'picker-tab-time': selectedDateTimeTab === 1
    }">
  <div class="calendar-container">

    <mat-tab-group mat-stretch-tabs dynamicHeight
                   *ngIf="datePickerModel.view === 'datetime' && mobileView; else ff"
                   (selectedIndexChange)="selectedDateTimeTabChange($event)">
      <mat-tab>
        <ng-template mat-tab-label>
          <ng-container *ngIf="datePickerModel.model$ | async as model; else noDate">
            {{ model | date: 'MMM d, yyyy'}}
          </ng-container>
          <ng-template #noDate>Date Not Selected</ng-template>
        </ng-template>
        <fs-date-picker-header
          [minYear]="datePickerModel.minYear"
          [maxYear]="datePickerModel.maxYear"
          [viewMode]="datePickerModel.dateMode"
          [disabledDays]="datePickerModel.disabledDays$ | async"
          (monthChange)="monthChanged($event)"
          (yearChange)="yearChanged($event)"
          (goNextMonth)="nextMonth()"
          (goPrevMonth)="prevMonth()"
        >
        </fs-date-picker-header>
      </mat-tab>

      <mat-tab>
        <ng-template mat-tab-label>
          <ng-container *ngIf="datePickerModel.model$ as model; else noTime">
            {{ model | async | date: 'h:mm'}}
            {{ model | async | date: 'aaa' | lowercase}}
          </ng-container>
          <ng-template #noTime>Time Not Selected</ng-template>
        </ng-template>

        <fs-date-picker-time
          *ngIf="datePickerModel.dateMode !== 'year' && datePickerModel.dateMode !== 'month'"
          [date]="datePickerModel.model$ | async"
          [minutes]="datePickerModel.minutes"
          [disabledTimes]="datePickerModel.disabledTimes$ | async"
          [expanded]="timePickerExpanded"
          (onChange)="setDate($event)"
        ></fs-date-picker-time>
      </mat-tab>
    </mat-tab-group>

    <ng-template #ff>
      <div class="date-time">
        <div class="calendar-view">
          <fs-date-picker-header
            [calendarDate]="datePickerModel.calendarDate$ | async"
            [minYear]="datePickerModel.minYear"
            [maxYear]="datePickerModel.maxYear"
            [viewMode]="datePickerModel.calendarMode$ | async"
            [disabledDays]="datePickerModel.disabledDays$ | async"
            (viewModeChange)="viewModeChanged($event)"
            (monthChange)="monthChanged($event)"
            (yearChange)="yearChanged($event)"
            (goNextMonth)="nextMonth()"
            (goPrevMonth)="prevMonth()"
          >
          </fs-date-picker-header>

          <ng-container *ngIf="dialogRef.components.calendarStart">
            <fs-date-picker-calendar
              [date]="datePickerModel.model$ | async"
              [drawMonth]="datePickerModel.calendarDate$ | async"
              [dateMode]="datePickerModel.calendarMode$ | async"
              [disabledDays]="datePickerModel.disabledDays$ | async"
              [period]="datePickerModel.period"
              [seedDate]="datePickerModel.seedDate"
              [periodWeeks]="datePickerModel.periodWeeks"
              (change)="dateChanged($event)"
              (periodChange)="periodChanged($event)">
            </fs-date-picker-calendar>
          </ng-container>
        </div>

        <ng-container
          *ngIf="datePickerModel.dateMode !== 'year' && datePickerModel.dateMode !== 'month'">
          <fs-date-picker-time
            *ngIf="datePickerModel.view === 'datetime' || datePickerModel.view === 'time'"
            [date]="datePickerModel.model$ | async"
            [minutes]="datePickerModel.minutes"
            [disabledTimes]="datePickerModel.disabledTimes$ | async"
            [expanded]="timePickerExpanded"
            (onChange)="setDate($event)"
          ></fs-date-picker-time>
        </ng-container>
      </div>
    </ng-template>

    <div class="buttons">
      <button class="button-done" type="button" mat-button color="primary" (click)="close()">Done</button>
      <button type="button"
              mat-button
              class="button-more"
              *ngIf="
                    datePickerModel.minutes
                    && (datePickerModel.view === 'datetime' || datePickerModel.view === 'time')
                    && !(mobileView && selectedDateTimeTab === 0 && datePickerModel.view === 'datetime'
                    && datePickerModel.dateMode === 'date')
                  "
              (click)="toggleTimeExpand()">
        <ng-container *ngIf="!timePickerExpanded; else lessMinutes">
          More Minutes
        </ng-container>
        <ng-template #lessMinutes>
          Less Minutes
        </ng-template>
      </button>
    </div>
  </div>
</div>
